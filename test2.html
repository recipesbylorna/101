<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
   </head>
   <body>
      <script>
         var myJSON;
         var recipeIndex = 0;
         function incrementRecipe(incrementor) {
            recipeIndex += incrementor;
            recipeIndex = (((recipeIndex % myJSON.recipes.length) + myJSON.recipes.length) % myJSON.recipes.length);
            
            updateRecipe(recipeIndex);
         }
         function updateRecipe(recipeNum) {
            updateName(recipeNum);
            updateCategory(recipeNum);
            updateMainIng(recipeNum);
            updateYieldAmount(recipeNum);
            updateYieldType(recipeNum);
            updateNotes(recipeNum);
            updateIngredients(recipeNum);
            updateInstructions(recipeNum);
            checkEmpty(recipeNum);
         }   
         function updateName(recipeNum) {
            document.getElementById("name").innerHTML = myJSON.recipes[recipeNum].name;
         }
         function updateCategory(recipeNum) {
            document.getElementById("category").innerHTML = myJSON.recipes[recipeNum].category;
         }
         function updateMainIng(recipeNum) {
            document.getElementById("mainIng").innerHTML = myJSON.recipes[recipeNum].mainIng;
         }
         function updateYieldAmount(recipeNum) {
            yieldAmount = myJSON.recipes[recipeNum].yieldAmount;
            document.getElementById("yieldAmount").innerHTML = myJSON.recipes[recipeNum].yieldAmount;
         }
         function updateYieldType(recipeNum) {
            document.getElementById("yieldType").innerHTML = myJSON.recipes[recipeNum].yieldType;
         }
         function updateNotes(recipeNum) {
            document.getElementById("notes").innerHTML = myJSON.recipes[recipeNum].notes;
         }
         function updateIngredients(recipeNum) {
            let x = "";
            let quantity;
            let ingredient;
            let preparation;
            for (let i = 0; i < myJSON.recipes[recipeNum].ingredients.length; i++) {
               quantity = myJSON.recipes[recipeNum].ingredients[i].quantity;
               ingredient = myJSON.recipes[recipeNum].ingredients[i].ingredient;
               preparation = myJSON.recipes[recipeNum].ingredients[i].preparation;
               x += quantity + " " + ingredient;
               if (preparation.localeCompare("") != 0) {
                  x += " - " + preparation;
               }
               x += "<br>";
            }
            document.getElementById("ingredients").innerHTML = x;
         }
         function updateInstructions(recipeNum) {
            document.getElementById("instructions").innerHTML = myJSON.recipes[recipeNum].instructions;
         }
         function checkEmpty(recipeNum) {
            let yield = document.getElementById("yield");
            let yieldAmount = myJSON.recipes[recipeNum].yieldAmount;
            if (yieldAmount.localeCompare("") == 0) {
               yield.style.display = "none";
            }
            else {
               yield.style.display = "block";
            }
            
            let noteBlock = document.getElementById("noteBlock");
            let notes = myJSON.recipes[recipeNum].notes;
            if (notes.localeCompare("") == 0) {
               noteBlock.style.display = "none";
            }
            else {
               noteBlock.style.display = "block";
            }
            
            let instructionBlock = document.getElementById("instructionBlock");
            let instructions = myJSON.recipes[recipeNum].instructions;
            if (instructions.localeCompare("") == 0) {
               instructionBlock.style.display = "none";
            }
            else {
               instructionBlock.style.display = "block";
            }
         }
         $(document).ready(function(){
           $.getJSON("/101/OUTPUT.JSON?r="+(new Date).getTime(), function(inputJSON){
             myJSON = inputJSON;
             updateRecipe(recipeIndex);
           }).fail(function(){
           console.log("An error has occurred.");
          });
         });
      </script>
      <button class="button center" type="button" onclick="incrementRecipe(-1)">Go Back One</button>
      <button class="button center" type="button" onclick="incrementRecipe(1)">Go Forward One</button>
      <div class="jumbotron text-center">
         <h1 id="name"></h1>
         <p id="category"></p>
      </div>
      <h3>Main Ingredient: <span id="mainIng"></span></h3>
      <h3 id="yield">Makes <span id="yieldAmount"></span> <span id="yieldType"></span></h3>
      <h2 id="noteBlock">Notes: <span id="notes"></span></h2>
      <h2>Ingredients:</h2>
      <h3><span id="ingredients"></span></h3>
      <h2 id="instructionBlock">Instructions:</h2>
      <p><span id="instructions"></span></p>
   </body>
</html>
